{"version":3,"sources":["components/signup-page/face.png","components/signin-page/face.png","services/canvas.js","services/backend.js","reducers/preview.js","components/spinner/Spinner.js","components/preview/Preview.js","components/download-success-modal/DownloadSuccessModal.js","components/social-login/SocialLogin.js","components/download-modal/DownloadModal.js","components/button-actions/ButtonActions.js","components/face-part-container/FacePartContainer.js","components/color-picker/ColorPicker.js","face-parts/Base.js","components/main-tabs/MainTabs.js","components/app-header/AppHeader.js","components/app-menu/AppMenu.js","components/avatar-page/AvatarPage.js","services/validations.js","components/signup-page/SignupPage.js","components/signin-page/SigninPage.js","App.js","serviceWorker.js","index.js"],"names":["module","exports","__webpack_require__","p","canvas","document","createElement","context","getContext","IMG_WIDTH","IMG_HEIGHT","width","height","changeImageColor","url","color","Promise","resolve","reject","img","src","onload","clearRect","drawImage","alpha","imageSmoothingQuality","globalCompositeOperation","fillStyle","fillRect","colorize","toDataURL","API_URL","process","instance","backend","Backend","_this","this","Object","classCallCheck","authAxios","axiosInstance","token","signup","body","post","signupFacebook","then","response","setAxiosInstance","data","localStorage","setItem","catch","e","signin","getProfileInfo","get","getFaceParts","setId","getSets","login","saveImage","method","responseType","params","logOut","removeItem","getItem","axios","create","baseURL","headers","Content-Type","Authorization","dispatch","type","payload","strategy","loginRequest","changeColor","part","getState","partsToInheritColor","partsDataOriginal","forEach","pd","index","inheritColorFrom","_id","push","images","el","value","inheritPart","getCurrentValues","createSelector","state","partsData","current","entries","values","_loop","i","key","find","zIndex","length","sort","a","b","map","v","getPreviewIsLoading","isLoading","reducer","initialState","handlers","arguments","undefined","action","hasOwnProperty","createReducer","profile","PARTS","PARTS_WITH_COLORS","partSprites","previewIsLoading","facePartsAreLoading","savingIsLoading","sets","hiddenParts","conflicts","SELECT_PART","_ref","_ref$payload","randomized","newCurrent","assign","partId","conflictedPart","objectSpread","defineProperty","SET_COLOR_START","_ref2","newPart","SET_COLOR","_ref3","_ref3$payload","newPartImages","concat","GET_PROFILE_INFO_SUCCESS","_ref4","LOGIN_SUCCESS","_ref5","LOGOUT","SET_PREVIEW_IS_LOADING","_ref6","GET_SETS_SUCCESS","_ref7","LOAD_FACE_PARTS_REQUEST","_ref8","LOAD_FACE_PARTS_SUCCESS","_ref9","newPartsData","cloneDeep","partIndex","unshift","conflictsWith","showOnStart","keys","pickBy","colors","SAVE_IMAGE_REQUEST","SAVE_IMAGE_SUCCESS","Spinner","_ref$width","_ref$height","react_default","className","style","connect","items","classNames","item","backgroundImage","alt","DownloadSuccessModal","props","lib_default","isOpen","onRequestClose","closeModal","imgBase64","Modal","setAppElement","name","facebook_login_render_props_default","appId","callback","res","console","log","onSuccessFacebookLogin","access_token","accessToken","render","renderProps","onClick","ti_index_esm","useEffect","onDownload","social_login_SocialLogin","randomizeFace","partsShuffled","Math","random","reduce","accum","includes","r","floor","toString","padStart","g","saveAs","Blob","_useState","useState","_useState2","slicedToArray","modalSuccessIsOpen","setModalSuccessIsOpen","_useState3","_useState4","modalDownloadIsOpen","setModalDownloadIsOpen","_useState5","_useState6","setImgBase64","disabled","index_esm","download_modal_DownloadModal","reader","FileReader","readAsDataURL","onloadend","base64data","result","FacePartContainer","id","active","selectPart","showPicker","setShowPicker","currentColor","setCurrentColor","onBackgroundClick","window","addEventListener","removeEventListener","stopPropagation","backgroundColor","background","react_color_lib","disableAlpha","onChange","hex","noColors","color_picker_ColorPicker","esm","defaultIndex","title","face_parts_Base","set","match","react_router_dom","to","preventDefault","BurgerMenu","right","Fragment","href","loadFaceParts","history","app_menu_AppMenu","app_header_AppHeader","preview_Preview","button_actions_ButtonActions","main_tabs_MainTabs","required","minLength","email","test","initialValues","password","repeatPassword","validate","errors","emailError","passwordError","repeatPasswordError","valueToEqual","passwordsMatch","face","formik_esm","validateOnChange","onSubmit","setSubmitting","toast","success","finally","touched","isSubmitting","handleChange","handleBlur","handleSubmit","htmlFor","placeholder","onBlur","App","possibleConstructorReturn","getPrototypeOf","call","react_toastify","autoClose","hideProgressBar","react_router","path","exact","component","AvatarPage","SignupPage","SigninPage","React","Component","Boolean","location","hostname","store","createStore","composeWithDevTools","applyMiddleware","ReduxThunk","ReactDOM","es","src_App_0","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.9c843a02.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/face.2c39ddd4.png\";","module.exports = __webpack_public_path__ + \"static/media/face.6721bc4f.png\";","const canvas = document.createElement(\"canvas\"), // shared instance\r\n  context = canvas.getContext(\"2d\");\r\n\r\nconst IMG_WIDTH = 600;\r\nconst IMG_HEIGHT = 600;\r\n\r\n// set image pixel size and hex color\r\ncanvas.width = IMG_WIDTH;\r\ncanvas.height = IMG_HEIGHT;\r\n\r\nexport const changeImageColor = (url, color) => {\r\n\r\n  return new Promise((resolve, reject) => {\r\n    let img = document.createElement('img');\r\n    img.src = url;\r\n    img.onload = () => {\r\n\r\n      context.clearRect(0, 0, canvas.width, canvas.height);\r\n      context.drawImage(img, 0, 0, canvas.width, canvas.height);\r\n      colorize(color, 1);\r\n\r\n      context.drawImage(img, 0, 0, canvas.width, canvas.height);\r\n      resolve(canvas.toDataURL(\"image/png\", 0.7));\r\n    }\r\n  })\r\n\r\n\r\n  function colorize(color, alpha) {\r\n    context.imageSmoothingQuality = \"medium\";\r\n    context.globalCompositeOperation = \"source-atop\";\r\n    context.fillStyle = color;\r\n    context.fillRect(0, 0, canvas.width, canvas.height);\r\n    context.globalCompositeOperation = \"multiply\";\r\n  }\r\n}\r\n\r\nexport const createSprite = (base64Urls) => {\r\n  const spriteCanvas = document.createElement(\"canvas\"),\r\n    ctx = spriteCanvas.getContext(\"2d\");\r\n  spriteCanvas.width = base64Urls.length * IMG_WIDTH;\r\n  spriteCanvas.height = IMG_HEIGHT;\r\n\r\n  return new Promise((resolve) => {\r\n\r\n    let promisesArray = [];\r\n\r\n    for (let i = 0; i < base64Urls.length; i++) {\r\n      promisesArray.push(drawImg(base64Urls[i], i * IMG_WIDTH, 0));\r\n    }\r\n\r\n    Promise.all(promisesArray).then(() => {\r\n      resolve(spriteCanvas.toDataURL(\"image/png\", 1));\r\n    })\r\n  });\r\n\r\n  function drawImg(url, x, y) {\r\n    return new Promise((resolve) => {\r\n      let img = document.createElement('img');\r\n      img.src = url;\r\n      img.onload = () => {\r\n        ctx.drawImage(img, x, y, IMG_WIDTH, IMG_HEIGHT);\r\n        resolve();\r\n      }\r\n    })\r\n  }\r\n}\r\n\r\n\r\n\r\n\r\n","import axios from 'axios';\r\n\r\nconst API_URL = process.env.REACT_APP_API_URL || 'http://localhost:3001/';\r\n\r\n\r\nlet instance = null;\r\n\r\nclass Backend {\r\n  authAxios = null;\r\n  axiosInstance = null;\r\n  token = null;\r\n\r\n  constructor() {\r\n    if (!instance) {\r\n      instance = this;\r\n      let token = localStorage.getItem('token');\r\n      if (token) {\r\n        this.token = token;\r\n      }\r\n      this.setAxiosInstance(token);\r\n    }\r\n    return instance;\r\n  }\r\n\r\n\r\n  signup = (body) => {\r\n    return this.axiosInstance.post(API_URL + 'auth/sign-up', body);\r\n  }\r\n\r\n  signupFacebook = (body) => {\r\n    return new Promise((resolve, reject) => {\r\n      this.axiosInstance.post(API_URL + 'auth/facebook/sign-up', body)\r\n        .then(response => {\r\n          this.setAxiosInstance(response.data.token);\r\n          localStorage.setItem('token', response.data.token);\r\n          resolve(response);\r\n        })\r\n        .catch(e => reject(e));\r\n    });\r\n  }\r\n\r\n  signin = (body) => {\r\n    return this.axiosInstance.post(API_URL + 'auth/login', body);\r\n  }\r\n\r\n  getProfileInfo = () => {\r\n    return this.authAxios.get(API_URL + 'profile/info');\r\n  }\r\n\r\n  getFaceParts = (setId) => {\r\n    return this.axiosInstance.get(API_URL + 'face-parts/' + setId);\r\n  }\r\n\r\n  getSets = () => {\r\n    return this.axiosInstance.get(API_URL + 'face-parts/sets');\r\n  }\r\n\r\n  login = (body) => {\r\n    return this.axiosInstance.post(API_URL + 'face-parts/login', body);\r\n  }\r\n\r\n  saveImage = (setId, data) => {\r\n    return this.axiosInstance({\r\n      url: API_URL + 'save-image/' + setId,\r\n      method: 'GET',\r\n      responseType: 'blob', // important,\r\n      params: { data }\r\n    })\r\n  }\r\n\r\n  logOut = () => {\r\n    this.token = null;\r\n    localStorage.removeItem('token');\r\n  }\r\n\r\n\r\n  // common methods\r\n\r\n  // request(method, ...args) {\r\n  //   return new Promise((resolve, reject) => {\r\n  //     this.authAxios[method](...args).then(response => {\r\n  //       resolve(response);\r\n  //     })\r\n  //       .catch(e => {\r\n  //         if (e.response && e.response.status === 401) {\r\n  //           window.location = (process.env.REACT_APP_ROUTER_BASE_URL || '') + '/#/login';\r\n  //         }\r\n  //         reject(e);\r\n  //       })\r\n  //   })\r\n  // }\r\n\r\n  // SET INSTANCE\r\n  setAxiosInstance(token) {\r\n    this.axiosInstance = axios.create({\r\n      baseURL: API_URL,\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n      }\r\n    });\r\n    this.authAxios = axios.create({\r\n      baseURL: API_URL,\r\n      headers: {\r\n        Authorization: 'jwt ' + token,\r\n        'Content-Type': 'application/json',\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nexport default new Backend();\r\n","import { createSelector } from 'reselect'\r\nimport { changeImageColor } from '../services/canvas'\r\nimport backend from '../services/backend'\r\nimport { cloneDeep, pickBy } from 'lodash'\r\nimport { saveAs } from 'file-saver';\r\n\r\nconst TRANSPARENT_PIXEL = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII='\r\nconst TRANSPARENT_ID = 'transparent'\r\n\r\nconst initialState = {\r\n  profile: null,\r\n  partsDataOriginal: {},\r\n  partsData: {},\r\n  PARTS: [],\r\n  PARTS_WITH_COLORS: [],\r\n  partSprites: [],\r\n  previewIsLoading: false,\r\n  facePartsAreLoading: true,\r\n  savingIsLoading: false,\r\n  sets: [],\r\n  hiddenParts: [], // for conflicts\r\n  conflicts: {},\r\n  current: {}\r\n  // current: {\r\n  //   head: {\r\n  //     _id: null,\r\n  //     color: null\r\n  //   }\r\n  // }\r\n};\r\n\r\nexport function createReducer(initialState, handlers) {\r\n  return function reducer(state = initialState, action) {\r\n    if (handlers.hasOwnProperty(action.type)) {\r\n      return handlers[action.type](state, action)\r\n    } else {\r\n      return state\r\n    }\r\n  }\r\n}\r\n\r\n// ACTIONS\r\n\r\nexport const loadFaceParts = (setId) => (dispatch) => {\r\n  dispatch({ type: 'LOAD_FACE_PARTS_REQUEST' });\r\n  backend.getFaceParts(setId).then(response => {\r\n    dispatch({ type: 'LOAD_FACE_PARTS_SUCCESS', payload: response });\r\n  }).catch(e => {\r\n    dispatch({ type: 'LOAD_FACE_PARTS_FAILURE', payload: e });\r\n  })\r\n}\r\n\r\nexport const getSets = () => (dispatch) => {\r\n  dispatch({ type: 'GET_SETS_REQUEST' });\r\n  return new Promise(resolve => {\r\n    backend.getSets().then(response => {\r\n      dispatch({ type: 'GET_SETS_SUCCESS', payload: response });\r\n      resolve(response);\r\n    }).catch(e => {\r\n      dispatch({ type: 'GET_SETS_FAILURE', payload: e });\r\n    })\r\n  })\r\n}\r\nexport const getProfileInfo = () => (dispatch) => {\r\n  if (!backend.token) return;\r\n  dispatch({ type: 'GET_PROFILE_INFO_REQUEST' });\r\n  return new Promise(resolve => {\r\n    backend.getProfileInfo().then(response => {\r\n      dispatch({ type: 'GET_PROFILE_INFO_SUCCESS', payload: response });\r\n      resolve(response);\r\n    }).catch(e => {\r\n      dispatch({ type: 'GET_PROFILE_INFO_FAILURE', payload: e });\r\n    })\r\n  })\r\n}\r\n\r\nexport const login = (body, strategy) => (dispatch) => {\r\n  dispatch({ type: 'LOGIN_REQUEST' });\r\n  let loginRequest = backend.signin;\r\n  if (strategy === 'facebook') {\r\n    loginRequest = backend.signupFacebook;\r\n  }\r\n  return loginRequest(body).then(response => {\r\n    dispatch({ type: 'LOGIN_SUCCESS', payload: response });\r\n  }).catch(e => {\r\n    dispatch({ type: 'LOGIN_FAILURE', payload: e });\r\n  })\r\n}\r\n\r\nexport const logOut = () => (dispatch) => {\r\n  backend.logOut();\r\n  dispatch({ type: 'LOGOUT'});\r\n\r\n}\r\n\r\nexport const saveImage = (setId) => (dispatch, getState) => {\r\n  const data = getState().current;\r\n\r\n  // createSprite(getState().partsData[2].images.map(img => img.value)).then(res => {\r\n  //   console.log(res);\r\n  // })\r\n\r\n  dispatch({ type: 'SAVE_IMAGE_REQUEST' });\r\n  return new Promise((resolve, reject) =>  {\r\n    backend.saveImage(setId, data).then(response => {\r\n      saveAs(new Blob([response.data]), 'image' + Math.floor(Math.random() * 100000 + 1) + '.png');\r\n      dispatch({ type: 'SAVE_IMAGE_SUCCESS', payload: response });\r\n      resolve(response);\r\n    }).catch(e => {\r\n      dispatch({ type: 'SAVE_IMAGE_FAILURE', payload: e });\r\n      reject(e);\r\n    })\r\n  });\r\n}\r\n\r\nexport const changeColor = (part, color) => (dispatch, getState) => {\r\n  let partsToInheritColor = [];\r\n  getState().partsDataOriginal.forEach((pd, index) => {\r\n    if (pd.inheritColorFrom === getState().partsDataOriginal[part]._id) {\r\n      partsToInheritColor.push(index);\r\n    }\r\n  })\r\n  getState().partsDataOriginal[part].images.forEach(el => {\r\n    changeImageColor(el.value, color).then((value) => {\r\n      dispatch({ type: 'SET_COLOR', payload: { _id: el._id, part, value, color } })\r\n    })\r\n  })\r\n  partsToInheritColor.forEach(inheritPart => {\r\n    getState().partsDataOriginal[inheritPart].images.forEach(el => {\r\n      changeImageColor(el.value, color).then((value) => {\r\n        dispatch({ type: 'SET_COLOR', payload: { _id: el._id, part: inheritPart, value, color } })\r\n      })\r\n    })\r\n  })\r\n}\r\n\r\n\r\nexport const randomizeFace = () => (dispatch, getState) => {\r\n\r\n  let partsShuffled = [].concat(getState().PARTS).sort(() => Math.random() - 0.5);\r\n  let conflicts = {}\r\n  partsShuffled.forEach(part => {\r\n    if (!getState().partsData[part].images.length) return\r\n    let conflictedArray = Object.values(conflicts).reduce((accum, value) => accum.concat(value), []);\r\n    if (conflictedArray.includes(getState().partsData[part]._id)) {\r\n      return dispatch({type: 'SELECT_PART', payload: {_id: TRANSPARENT_ID, part, randomized: true }})\r\n    };\r\n\r\n    if (getState().PARTS_WITH_COLORS.includes(part)) {\r\n      let r = Math.floor(Math.random() * 255).toString(16).padStart(2, '0')\r\n      let g = Math.floor(Math.random() * 255).toString(16).padStart(2, '0')\r\n      let b = Math.floor(Math.random() * 255).toString(16).padStart(2, '0')\r\n      dispatch(changeColor(part, '#' + r + g + b))\r\n      dispatch({type: 'SET_COLOR_START', payload: { part }})\r\n    }\r\n\r\n    let index = Math.floor(Math.random() * (getState().partsData[part].images.length - 1)) + 1;\r\n    let _id = getState().partsData[part].images[index]._id;\r\n    dispatch({type: 'SELECT_PART', payload: {_id, part, randomized: true }})\r\n    conflicts[part] = getState().conflicts[getState().partsData[part]._id];\r\n  })\r\n}\r\n\r\n\r\n\r\n\r\n// SELECTORS\r\n//\r\nexport const getCurrentValues = createSelector(\r\n  state => state.partsData,\r\n  state => state.current,\r\n  (partsData, current) => {\r\n    let entries = Object.entries(partsData);\r\n    let values = [];\r\n    for (let i = 0; i < entries.length; i ++) {\r\n      let key = entries[i][0];\r\n      if (!current[key]) continue;\r\n      let value = entries[i][1].images.find(el => el._id === current[key]._id)\r\n      values.push({\r\n        zIndex: entries[i][1].zIndex,\r\n        value: value\r\n      });\r\n    }\r\n    values = values.sort((a, b) => a.zIndex - b.zIndex)\r\n    values = values.map(v => v.value && v.value.value)\r\n    return values\r\n  }\r\n)\r\n\r\nexport const getPreviewIsLoading = createSelector(state => state.partsData, partsData => {\r\n  if (!partsData) return true;\r\n  for (let index in partsData) {\r\n    for (let i = 0; i < partsData[index].images.length; i++) {\r\n      if (partsData[index].images[i].isLoading) {\r\n        return true;\r\n      }\r\n    }\r\n  }\r\n  return false;\r\n});\r\n\r\n// REDUCER\r\n\r\nconst reducer = createReducer(initialState, {\r\n  SELECT_PART: function(state, { payload: { _id, part, randomized }}) {\r\n    let newCurrent = Object.assign({}, state.current);\r\n\r\n    let partId = state.partsData[part]._id;\r\n\r\n    if (!randomized && state.conflicts[partId]) {\r\n      state.conflicts[partId].forEach(conflictedPart => {\r\n        for (let index in state.partsData) {\r\n          if (state.partsData[index]._id === conflictedPart) {\r\n            newCurrent[index] && (newCurrent[index]._id = TRANSPARENT_ID);\r\n          }\r\n        }\r\n      });\r\n    }\r\n    return {\r\n      ...state,\r\n      current: {\r\n        ...newCurrent,\r\n        [part]: {\r\n          ...state.current[part],\r\n          _id: _id,\r\n        }\r\n      }\r\n    }\r\n  },\r\n  SET_COLOR_START: function(state, { payload: { part }}) {\r\n    let newPart = Object.assign({}, state.partsData[part]);\r\n    newPart.images && newPart.images.forEach(img => img.isLoading = true);\r\n    return {\r\n      ...state,\r\n      partsData: {\r\n        ...state.partsData,\r\n        [part]: newPart\r\n      }\r\n    }\r\n  },\r\n  SET_COLOR: function(state, { payload: {_id, part, value, color }}) {\r\n    let newPartImages = [].concat(state.partsData[part].images)\r\n    newPartImages.find(el => el._id === _id).value = value;\r\n    newPartImages.find(el => el._id === _id).isLoading = false;\r\n    return {\r\n      ...state,\r\n      partsData: {\r\n        ...state.partsData,\r\n        [part]: {\r\n          ...state.partsData[part],\r\n          images: newPartImages\r\n        }\r\n      },\r\n      current: {\r\n        ...state.current,\r\n        [part]: {\r\n          ...state.current[part],\r\n          color\r\n        }\r\n      }\r\n    }\r\n  },\r\n  GET_PROFILE_INFO_SUCCESS: function(state, { payload }) {\r\n    return {\r\n      ...state,\r\n      profile: payload.data\r\n    }\r\n  },\r\n  LOGIN_SUCCESS: function(state, { payload }) {\r\n    return {\r\n      ...state,\r\n      profile: payload.data\r\n    }\r\n  },\r\n  LOGOUT: function(state) {\r\n    return {\r\n      ...state,\r\n      profile: null\r\n    }\r\n  },\r\n  SET_PREVIEW_IS_LOADING: function(state, { value }) {\r\n    return {\r\n      ...state,\r\n      previewIsLoading: value\r\n    }\r\n  },\r\n  GET_SETS_SUCCESS: function(state, { payload }) {\r\n    return {\r\n      ...state,\r\n      sets: payload.data\r\n    }\r\n  },\r\n  LOAD_FACE_PARTS_REQUEST: function(state, { payload }) {\r\n    return {\r\n      ...state,\r\n      current: {},\r\n      partsDataOriginal: {},\r\n      partsData: {},\r\n      PARTS: [],\r\n      PARTS_WITH_COLORS: [],\r\n      facePartsAreLoading: true\r\n    }\r\n  },\r\n  LOAD_FACE_PARTS_SUCCESS: function(state, { payload }) {\r\n    let newPartsData =  cloneDeep(payload.data);\r\n    let newCurrent = Object.assign({}, state.current);\r\n    let conflicts = {};\r\n    newPartsData.forEach((part, partIndex) => {\r\n      part.images.unshift({\r\n        _id: TRANSPARENT_ID,\r\n        value: TRANSPARENT_PIXEL\r\n      });\r\n      part.images.forEach(img => {\r\n        img.isLoading = false;\r\n      })\r\n      if (part.conflictsWith.length) {\r\n        if (conflicts[part._id]) conflicts[part._id].concat(part.conflictsWith);\r\n        else conflicts[part._id] = part.conflictsWith;\r\n        conflicts[part._id] = part.conflictsWith;\r\n        part.conflictsWith.forEach(conflictedPart => {\r\n          if (conflicts[conflictedPart]) conflicts[conflictedPart].push(part._id);\r\n          else conflicts[conflictedPart] = [part._id];\r\n        })\r\n      }\r\n      // set current\r\n      if (part.showOnStart) {\r\n        newCurrent[partIndex] = {\r\n          _id: part.images[1]._id\r\n        };\r\n      } else {\r\n        newCurrent[partIndex] = {\r\n          _id: TRANSPARENT_ID\r\n        };\r\n      }\r\n    })\r\n\r\n    return {\r\n      ...state,\r\n      conflicts,\r\n      partsData: newPartsData,\r\n      partsDataOriginal: cloneDeep(newPartsData),\r\n      PARTS: Object.keys(payload.data),\r\n      PARTS_WITH_COLORS: Object.keys(pickBy(payload.data, part => part.colors && part.colors.length)),\r\n      facePartsAreLoading: false,\r\n      current: newCurrent\r\n    }\r\n  },\r\n  SAVE_IMAGE_REQUEST: function(state) {\r\n    return {\r\n      ...state,\r\n      savingIsLoading: true\r\n    }\r\n  },\r\n  SAVE_IMAGE_SUCCESS: function(state) {\r\n    return {\r\n      ...state,\r\n      savingIsLoading: false\r\n    }\r\n  }\r\n})\r\n\r\nexport default reducer\r\n","import React from 'react';\r\nimport './spinner.scss'\r\n\r\nexport default function Spinner ({width = 300, height = 300}) {\r\n  return (\r\n    <div className=\"spinner\" style={{width, height}}>Loading...</div>\r\n  )\r\n}\r\n","import React from 'react';\r\nimport { connect } from 'react-redux'\r\nimport { getCurrentValues, getPreviewIsLoading } from '../../reducers/preview'\r\nimport Spinner from '../spinner'\r\nimport classNames from 'classnames'\r\n\r\nimport './preview.scss'\r\n\r\nfunction Preview({ items, previewIsLoading, setId }) {\r\n  return (\r\n    <div className={classNames('Preview', previewIsLoading && 'isLoading')}>\r\n\r\n      <div className=\"images\">\r\n        {\r\n          items.map((item, index) => (\r\n            <div className=\"img\" style={{backgroundImage: 'url(' + item + ')'}} key={index} alt=\"\"/>\r\n          ))\r\n        }\r\n      </div>\r\n      <Spinner />\r\n    </div>\r\n  )\r\n}\r\n\r\n\r\nexport default connect(\r\n  state => ({\r\n    items: getCurrentValues(state),\r\n    current: state.current,\r\n    previewIsLoading: state.facePartsAreLoading || getPreviewIsLoading(state) || state.savingIsLoading\r\n  })\r\n)(Preview)\r\n","import React from 'react';\r\nimport './download-success-modal.scss'\r\nimport Modal from 'react-modal';\r\n\r\nModal.setAppElement('#root')\r\n\r\nexport default function DownloadSuccessModal(props) {\r\n\r\n  return (\r\n    <Modal\r\n      isOpen={props.isOpen}\r\n      onRequestClose={props.closeModal}\r\n      className=\"download-success-modal\"\r\n    >\r\n      <h4>Great! Your download has been successful!</h4>\r\n      <img className=\"modal-image\" src={props.imgBase64} alt=\"\"/>\r\n      <h6>If you want to download images in high quality, you can <strong>become premium</strong></h6>\r\n    </Modal>\r\n  )\r\n}\r\n","import React from 'react';\r\nimport { connect } from 'react-redux'\r\nimport './social-login.scss'\r\nimport { GoogleLogin } from 'react-google-login';\r\nimport FacebookLogin from 'react-facebook-login/dist/facebook-login-render-props';\r\nimport { TiSocialFacebookCircular } from 'react-icons/ti/';\r\nimport { login } from '../../reducers/preview';\r\n\r\n\r\n\r\nfunction SocialLogin(props) {\r\n\r\n  const onSuccessGoogleLogin = (res) => {\r\n    //console.log(res.profileObj);\r\n    // props.login({ profile: res.profileObj });\r\n  }\r\n\r\n  const onSuccessFacebookLogin = (res) => {\r\n    console.log(res);\r\n    props.onSuccessFacebookLogin({access_token: res.accessToken});\r\n    // props.login({ profile: res });\r\n  }\r\n\r\n  return (\r\n    <div className=\"SocialLogin\">\r\n\r\n      {props.profile ? (\r\n        <div>\r\n          You are logged in as {props.profile.name}\r\n        </div>\r\n      ) : (\r\n        <div>\r\n          {/*<p>Sign in with a social network:</p>*/}\r\n          {/*<button onClick={onSuccessGoogleLogin}>Add</button>*/}\r\n          {/*<GoogleLogin*/}\r\n          {/*  clientId=\"546998968320-0cn7qut7aklej8akfljup6hi9a7najba.apps.googleusercontent.com\"*/}\r\n          {/*  // autoLoad={true}*/}\r\n          {/*  buttonText=\"Google\"*/}\r\n          {/*  onSuccess={onSuccessGoogleLogin}*/}\r\n          {/*  onFailure={(err) => console.log(err)}*/}\r\n          {/*/>*/}\r\n          <FacebookLogin\r\n            appId=\"375214849866140\"\r\n            // autoLoad={true}\r\n            callback={onSuccessFacebookLogin}\r\n            // fields=\"name,email,picture\"\r\n            render={renderProps => (\r\n              <button className=\"fb-button\" onClick={renderProps.onClick}>\r\n                <TiSocialFacebookCircular />\r\n                Sign up with Facebook\r\n              </button>\r\n            )}\r\n          />\r\n        </div>\r\n      )}\r\n    </div>\r\n  )\r\n}\r\n\r\n\r\nexport default connect(\r\n  state => ({\r\n    profile: state.profile\r\n  }),\r\n  {\r\n    login\r\n  }\r\n)(SocialLogin)\r\n","import React, {useEffect} from 'react';\r\nimport './download-modal.scss'\r\nimport Modal from 'react-modal';\r\nimport SocialLogin from '../social-login';\r\nimport { connect } from 'react-redux'\r\nimport Spinner from '../spinner';\r\n\r\nModal.setAppElement('#root')\r\n\r\nfunction DownloadModal(props) {\r\n\r\n  useEffect(() => {\r\n    if (props.profile && props.isOpen) {\r\n      props.onDownload();\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [props.profile, props.isOpen])\r\n\r\n  return (\r\n    <Modal\r\n      isOpen={props.isOpen}\r\n      onRequestClose={props.closeModal}\r\n      className=\"download-modal\"\r\n    >\r\n      {props.profile ?\r\n        (\r\n          <div>\r\n            <div>\r\n              You are logged in as {props.profile.name}\r\n            </div>\r\n            <p>\r\n              Downloading...\r\n              <div className=\"spinner-wrapper\">\r\n                <Spinner width={100} height={100} />\r\n              </div>\r\n            </p>\r\n          </div>\r\n        ) : (\r\n          <div>\r\n            <h4>Please sign in to download!</h4>\r\n            <SocialLogin/>\r\n          </div>\r\n        )\r\n      }\r\n    </Modal>\r\n  )\r\n}\r\n\r\nexport default connect(\r\n  state => ({\r\n    profile: state.profile\r\n  })\r\n)(DownloadModal)\r\n","import React, {useState} from 'react';\r\nimport { connect } from 'react-redux'\r\nimport { getPreviewIsLoading, randomizeFace, saveImage } from '../../reducers/preview'\r\nimport './button-actions.scss'\r\nimport { FaDownload, FaRandom } from 'react-icons/fa'\r\n\r\nimport DownloadSuccessModal from '../download-success-modal'\r\nimport DownloadModal from '../download-modal'\r\n\r\n\r\nfunction ButtonActions(props) {\r\n\r\n  let [modalSuccessIsOpen, setModalSuccessIsOpen] = useState(false);\r\n  let [modalDownloadIsOpen, setModalDownloadIsOpen] = useState(false);\r\n  let [imgBase64, setImgBase64] = useState(null);\r\n\r\n  function onDownload() {\r\n    props.saveImage(props.setId).then((response) => {\r\n      var reader = new FileReader();\r\n      reader.readAsDataURL(response.data);\r\n      reader.onloadend = function() {\r\n        let base64data = reader.result;\r\n        setImgBase64(base64data);\r\n        setModalSuccessIsOpen(true);\r\n        setModalDownloadIsOpen(false);\r\n      }\r\n    })\r\n  }\r\n\r\n  return (\r\n    <div className=\"ButtonActions\">\r\n      <button\r\n        className=\"btn btn-primary btn-wide mb-2\"\r\n        onClick={props.randomizeFace}\r\n        disabled={props.savingIsLoading || props.previewIsLoading}\r\n      >\r\n        <FaRandom />&nbsp;\r\n        <span className=\"button-text\">Random</span>\r\n      </button>\r\n      <br/>\r\n      <button\r\n        className=\"btn btn-primary btn-wide\"\r\n        onClick={() => setModalDownloadIsOpen(true)}\r\n        disabled={props.savingIsLoading || props.previewIsLoading}\r\n      >\r\n        <FaDownload />&nbsp;\r\n        <span className=\"button-text\">Download</span>\r\n      </button>\r\n      <DownloadModal\r\n        isOpen={modalDownloadIsOpen}\r\n        closeModal={() => setModalDownloadIsOpen(false)}\r\n        onDownload={onDownload}\r\n      />\r\n      <DownloadSuccessModal\r\n        isOpen={modalSuccessIsOpen}\r\n        closeModal={() => setModalSuccessIsOpen(false)}\r\n        imgBase64={imgBase64}\r\n      />\r\n    </div>\r\n  )\r\n}\r\n\r\n\r\n\r\nexport default connect(\r\n  state => ({\r\n    savingIsLoading: state.savingIsLoading,\r\n    previewIsLoading: state.facePartsAreLoading || getPreviewIsLoading(state)\r\n  }),\r\n  dispatch => ({\r\n    randomizeFace: () => dispatch(randomizeFace()),\r\n    saveImage: (setId) => dispatch(saveImage(setId))\r\n  })\r\n)(ButtonActions)\r\n","import React from 'react';\r\nimport './face-part-container.scss'\r\nimport classNames from 'classnames'\r\n\r\nexport default function FacePartContainer ({id, active, part, url, selectPart}) {\r\n  return (\r\n    <div className={classNames('FacePartContainer', active && 'active')} onClick={() => selectPart(id, part)}>\r\n      <img src={url} alt=\"\"/>\r\n    </div>\r\n  )\r\n}\r\n","import React, { useState, useEffect } from 'react';\r\nimport { connect } from 'react-redux'\r\nimport { changeColor } from '../../reducers/preview'\r\nimport './color-picker.scss'\r\nimport { ChromePicker } from 'react-color'\r\nimport { FaEyeDropper } from 'react-icons/fa'\r\n\r\n\r\nfunction ColorPicker({ part, changeColor, partsData, current }) {\r\n  const [showPicker, setShowPicker] = useState(false)\r\n  const [currentColor, setCurrentColor] = useState((current[part] && current[part].color) || '#ffffff');\r\n  const colors = partsData[part].colors;\r\n\r\n  const onBackgroundClick = () => {\r\n    setShowPicker(false)\r\n  }\r\n\r\n  useEffect(() => {\r\n    window.addEventListener('click', onBackgroundClick, false)\r\n    return function cleanup() {\r\n      window.removeEventListener('click', onBackgroundClick)\r\n    }\r\n  }, [])\r\n\r\n  if (!colors || !colors.length) return null;\r\n\r\n  return (\r\n    <div className=\"ColorPicker\" onClick={e => e.stopPropagation()}>\r\n      <div\r\n        className=\"color color-pipette\"\r\n        onClick={() => {\r\n          setShowPicker(!showPicker)\r\n        }}\r\n        style={{backgroundColor: (current[part] && current[part].color) || currentColor}}\r\n      >\r\n        <FaEyeDropper/>\r\n      </div>\r\n      {colors.map(color => (\r\n       <div className=\"color\"\r\n            style={{background: color}}\r\n            key={color}\r\n            onClick={() => changeColor(part, color)}>\r\n       </div>\r\n      ))}\r\n      { showPicker &&\r\n        <ChromePicker\r\n          className=\"chromePicker\"\r\n          disableAlpha={true}\r\n          color={(current[part] && current[part].color) || currentColor}\r\n\r\n          onChange={(color) => {\r\n            setCurrentColor(color.hex);\r\n            changeColor(part, color.hex);\r\n          }}\r\n        />\r\n      }\r\n    </div>\r\n  )\r\n}\r\n\r\n\r\nexport default connect(\r\n  state => ({\r\n    partsData: state.partsData,\r\n    current: state.current\r\n  }),\r\n  dispatch => ({\r\n    changeColor: (part, color) => dispatch(changeColor(part, color)),\r\n  })\r\n)(ColorPicker)\r\n","import React from 'react';\r\nimport FacePartContainer from '../components/face-part-container'\r\nimport { connect } from 'react-redux'\r\nimport { changeColor } from '../reducers/preview'\r\nimport ColorPicker from '../components/color-picker'\r\n\r\nfunction Base({items, current, changeColor, selectPart, part, noColors}) {\r\n  if (!(items && items[part] && items[part].images && items[part].images.length)) return 'No items on this layer'\r\n  return (\r\n    <div>\r\n      { items[part].images.map(item => (\r\n        <FacePartContainer\r\n          active={current && current[part] && (current[part]._id === item._id)}\r\n          key={item._id}\r\n          id={item._id}\r\n          part={part}\r\n          url={item.value}\r\n          selectPart={selectPart}\r\n        />\r\n      )) }\r\n      <br/>\r\n      { !items[part].inheritColorFrom && <ColorPicker part={part} /> }\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default connect(\r\n  state => ({\r\n    items: state.partsData,\r\n    current: state.current\r\n  }),\r\n  dispatch => ({\r\n    changeColor: (part, color) => dispatch(changeColor(part, color)),\r\n    selectPart: (_id, part) => dispatch({ type: 'SELECT_PART', payload: {_id, part} })\r\n  })\r\n)(Base)\r\n","import React from 'react';\r\nimport {connect} from 'react-redux';\r\nimport './main-tabs.scss'\r\nimport { Tab, TabList, TabPanel, Tabs } from 'react-tabs'\r\nimport Base from '../../face-parts/Base'\r\n\r\nfunction MainTabs({ PARTS, partsData }) {\r\n  if (!PARTS || !PARTS.length) {\r\n    return <div></div>\r\n  }\r\n  return (\r\n    <div className=\"MainTabs\">\r\n      <Tabs defaultIndex={0}>\r\n        <TabList>\r\n          {PARTS.map((part, index) => (\r\n            <Tab key={index}>{partsData[part].title}</Tab>\r\n          ))}\r\n        </TabList>\r\n\r\n        {PARTS.map((part, index) => (\r\n          <TabPanel key={index}>\r\n            <Base part={part}/>\r\n          </TabPanel>\r\n        ))}\r\n\r\n      </Tabs>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default connect(\r\n  state => ({\r\n    PARTS: state.PARTS,\r\n    partsData: state.partsData\r\n  })\r\n)(MainTabs)\r\n","import React from 'react'\r\nimport './app-header.scss'\r\nimport { FaGrinTongue } from 'react-icons/fa'\r\nimport { Link } from 'react-router-dom'\r\nimport { connect } from 'react-redux'\r\n\r\nfunction AppHeader(props) {\r\n  return (\r\n    <div className=\"AppHeader\">\r\n      <div className=\"logo\">\r\n        <FaGrinTongue />\r\n        Avatar Maker\r\n      </div>\r\n      <ul className=\"menu-items\">\r\n        {props.sets.map((set, index) => (\r\n          <li key={index}>\r\n            { (props.match && (props.match.params.setId === set._id)) ? (\r\n              <Link to={set._id} onClick={e => e.preventDefault()} className='disabled'>\r\n                {set.name}\r\n              </Link>\r\n            ) : (\r\n              <Link to={set._id}>\r\n                {set.name}\r\n              </Link>\r\n            ) }\r\n          </li>\r\n        ))}\r\n      </ul>\r\n      {\r\n        props.profile ? (\r\n          <div className=\"profile-name\">\r\n            {props.profile.name}\r\n          </div>\r\n        ) : (\r\n          <div className=\"signup-wrapper\">\r\n            <Link to='/signup'>\r\n              <button className=\"btn btn-info btn-sm\">SIGN UP</button>\r\n            </Link>\r\n          </div>\r\n        )\r\n      }\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default connect(\r\n  state => ({\r\n    sets: state.sets,\r\n    profile: state.profile\r\n  })\r\n)(AppHeader)\r\n","import React from 'react'\r\nimport './app-menu.scss'\r\nimport { connect } from 'react-redux'\r\nimport { slide as Menu } from 'react-burger-menu'\r\nimport { Link } from 'react-router-dom'\r\nimport { FaSignInAlt, FaUserPlus, FaSignOutAlt } from 'react-icons/fa'\r\nimport { logOut } from '../../reducers/preview';\r\n\r\nfunction AppMenu(props) {\r\n\r\n  function logOut(e) {\r\n    e.preventDefault();\r\n    props.logOut();\r\n  }\r\n\r\n  return (\r\n    <div className=\"AppMenu\">\r\n      <Menu right width={ 280 }>\r\n        { props.profile ?\r\n          (\r\n            <React.Fragment>\r\n              <a id=\"logOut\" className=\"menu-item\" href=\"\" onClick={logOut}>\r\n                <FaSignOutAlt />&nbsp;<span>Log out</span>\r\n              </a>\r\n            </React.Fragment>\r\n          ) :\r\n          (\r\n            <React.Fragment>\r\n              <Link id=\"signUp\" className=\"menu-item\" to=\"/signup\">\r\n                <FaUserPlus />&nbsp;<span>Sign Up</span>\r\n              </Link>\r\n              <Link id=\"signIn\" className=\"menu-item\" to=\"/signin\">\r\n                <FaSignInAlt />&nbsp;<span>Log In</span>\r\n              </Link>\r\n            </React.Fragment>\r\n          )\r\n        }\r\n\r\n        <ul className=\"menu-items\">\r\n          {props.sets.map((set, index) => (\r\n            <li key={index}>\r\n              { (props.match && (props.match.params.setId === set._id)) ? (\r\n                <Link to={set._id} onClick={e => e.preventDefault()} className='disabled'>\r\n                  {set.name}\r\n                </Link>\r\n              ) : (\r\n                <Link to={set._id}>\r\n                  {set.name}\r\n                </Link>\r\n              ) }\r\n            </li>\r\n          ))}\r\n        </ul>\r\n      </Menu>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default connect(\r\n  state => ({\r\n    sets: state.sets,\r\n    profile: state.profile\r\n  }),\r\n  {\r\n    logOut\r\n  }\r\n)(AppMenu)\r\n","import React, {useEffect} from 'react';\r\nimport { connect } from 'react-redux'\r\nimport './avatar-page.scss'\r\n\r\nimport Preview from '../../components/preview'\r\nimport ButtonActions from '../../components/button-actions'\r\nimport { getSets, loadFaceParts } from '../../reducers/preview'\r\nimport MainTabs from '../../components/main-tabs'\r\nimport AppHeader from '../../components/app-header'\r\nimport AppMenu from '../../components/app-menu'\r\n\r\n\r\nfunction AvatarPage(props) {\r\n\r\n  useEffect(() => {\r\n    props.getSets().then(response => {\r\n      if (!props.match.params.setId) {\r\n        props.history.push(response.data[0]._id);\r\n      }\r\n    });\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (props.match.params.setId) {\r\n      props.loadFaceParts(props.match.params.setId);\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [props.match.params.setId]);\r\n\r\n  return (\r\n    <div className=\"AvatarPage\">\r\n      <AppMenu match={props.match}/>\r\n      <AppHeader match={props.match}/>\r\n      <aside className=\"App-left-col\">\r\n        <div className=\"left-col-container\">\r\n          <Preview setId={props.match.params.setId}/>\r\n          <br/>\r\n          <ButtonActions setId={props.match.params.setId}/>\r\n        </div>\r\n      </aside>\r\n      <main className=\"App-main\">\r\n        <MainTabs />\r\n      </main>\r\n    </div>\r\n  )\r\n}\r\n\r\n\r\nexport default connect(\r\n  state => ({\r\n    sets: state.sets\r\n  }),\r\n  {\r\n    loadFaceParts,\r\n    getSets\r\n  }\r\n)(AvatarPage)\r\n","export function required(value) {\r\n  if (!value) {\r\n    return 'Field is required'\r\n  }\r\n}\r\n\r\nexport function cleanText(value) {\r\n  const CLEAN_TEXT = /^[^`~!@#$%^&*()+=[{\\]}|\\\\'<,.>?\";:]+$/;\r\n  if (!CLEAN_TEXT.test(value)) {\r\n    return 'No special characters allowed'\r\n  }\r\n}\r\n\r\nexport function minLength(value, length) {\r\n  if (value.length < length) {\r\n    return `Min length have to be ${length}`;\r\n  }\r\n}\r\n\r\nexport function email(value) {\r\n  const EMAIL = /^[A-Z0-9._%+-]+@[A-Z0-9.-]+\\.[A-Z]{2,4}$/i;\r\n  if (!EMAIL.test(value)) {\r\n    return 'Invalid email address'\r\n  }\r\n}\r\n\r\nexport function passwordsMatch(value, valueToEqual) {\r\n  if (value !== valueToEqual) {\r\n    return 'Passwords does not match'\r\n  }\r\n}\r\n","import React, {useEffect} from 'react';\r\nimport { connect } from 'react-redux'\r\nimport { getSets, login } from '../../reducers/preview'\r\nimport './signup-page.scss'\r\nimport { Link } from \"react-router-dom\";\r\nimport face from './face.png';\r\nimport { Formik } from 'formik';\r\nimport { required, email, passwordsMatch, minLength } from '../../services/validations';\r\nimport classNames from 'classnames';\r\nimport backend from '../../services/backend'\r\nimport { toast } from 'react-toastify';\r\nimport SocialLogin from '../../components/social-login';\r\n\r\n\r\nimport AppHeader from '../../components/app-header'\r\nimport AppMenu from '../../components/app-menu'\r\n\r\n\r\n\r\nconst initialValues = {\r\n  email: '',\r\n  password: '',\r\n  repeatPassword: ''\r\n};\r\n\r\nconst validate = values => {\r\n  let errors = {};\r\n  let emailError = required(values.email) || email(values.email);\r\n  if (emailError) {\r\n    errors.email = emailError;\r\n  }\r\n  let passwordError = required(values.password) || minLength(values.password, 6);\r\n  if (passwordError) {\r\n    errors.password = passwordError;\r\n  }\r\n  let repeatPasswordError = required(values.repeatPassword) || passwordsMatch(values.repeatPassword, values.password);\r\n  if (repeatPasswordError) {\r\n    errors.repeatPassword = repeatPasswordError;\r\n  }\r\n\r\n  return errors\r\n};\r\n\r\n\r\nfunction SignupPage(props) {\r\n\r\n  function onSuccessFacebookLogin(res) {\r\n    props.login(res, 'facebook').then(() => {\r\n      backend.getProfileInfo().then(() => {\r\n        props.history.push('/');\r\n      });\r\n    });\r\n  }\r\n\r\n  return (\r\n    <div className=\"SignupPage\">\r\n      <AppHeader />\r\n      <AppMenu />\r\n      <div className=\"wrapper\">\r\n        <div className=\"left-col\">\r\n          <img src={face} alt=\"\"/>\r\n        </div>\r\n        <div className=\"right-col\">\r\n          <div className=\"form-wrapper\">\r\n            <h5 className=\"title\">Sign up</h5>\r\n            <SocialLogin onSuccessFacebookLogin={onSuccessFacebookLogin} />\r\n            <Formik\r\n              initialValues={initialValues}\r\n              validate={validate}\r\n              validateOnChange={true}\r\n              onSubmit={(values, { setSubmitting }) => {\r\n                console.log(values);\r\n                backend.signup(values)\r\n                  .then(response => {\r\n                    toast.success('Form was successfully saved')\r\n                  })\r\n                  .catch(() => {})\r\n                  .finally(() => setSubmitting(false))\r\n              }}\r\n            >\r\n              {props => {\r\n                const {\r\n                  values,\r\n                  errors,\r\n                  touched,\r\n                  isSubmitting,\r\n                  handleChange,\r\n                  handleBlur,\r\n                  handleSubmit,\r\n                } = props;\r\n                return (\r\n                  <form onSubmit={handleSubmit}>\r\n                    <div className=\"control form-group\">\r\n                      <label htmlFor=\"email\" className=\"label\">Email</label>\r\n                      <input\r\n                        id=\"email\"\r\n                        name=\"email\"\r\n                        type=\"text\"\r\n                        value={values.email}\r\n                        placeholder=\"Email\"\r\n                        onChange={handleChange}\r\n                        onBlur={handleBlur}\r\n                        className={classNames('input form-control', touched.email && errors.email && 'error')}\r\n                      />\r\n                      { touched.email && errors.email &&\r\n                      <div className=\"error-message\">{ errors.email }</div> }\r\n                    </div>\r\n\r\n                    <div className=\"control form-group\">\r\n                      <label htmlFor=\"password\" className=\"label\">Password</label>\r\n                      <input\r\n                        id=\"password\"\r\n                        name=\"password\"\r\n                        type=\"password\"\r\n                        value={values.password}\r\n                        placeholder=\"Password\"\r\n                        onChange={handleChange}\r\n                        className={classNames('input form-control', touched.password && errors.password && 'error')}\r\n                      />\r\n                      { touched.password && errors.password &&\r\n                      <div className=\"error-message\">{ errors.password }</div> }\r\n                    </div>\r\n\r\n                    <div className=\"control form-group\">\r\n                      <label htmlFor=\"repeatPassword\" className=\"label\">Repeat your password</label>\r\n                      <input\r\n                        id=\"repeatPassword\"\r\n                        name=\"repeatPassword\"\r\n                        type=\"password\"\r\n                        value={values.repeatPassword}\r\n                        placeholder=\"Repeat your password\"\r\n                        onChange={handleChange}\r\n                        className={classNames('input form-control', touched.password && errors.password && 'error')}\r\n                      />\r\n                      { touched.repeatPassword && errors.repeatPassword &&\r\n                      <div className=\"error-message\">{ errors.repeatPassword }</div> }\r\n                    </div>\r\n                    <div className=\"control form-group\">\r\n                      <input\r\n                        type=\"submit\"\r\n                        value=\"Sign Up\"\r\n                        disabled={isSubmitting}\r\n                        className=\"submit btn btn-block btn-lg btn-primary\"\r\n                      />\r\n                    </div>\r\n                  </form>\r\n                );\r\n              }}\r\n            </Formik>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\n\r\nexport default connect(\r\n  state => ({\r\n    sets: state.sets\r\n  }),\r\n  {\r\n    getSets,\r\n    login\r\n  }\r\n)(SignupPage)\r\n","import React, {useEffect} from 'react';\r\nimport { connect } from 'react-redux'\r\nimport { getSets, login } from '../../reducers/preview'\r\nimport './signin-page.scss'\r\nimport { Link } from \"react-router-dom\";\r\nimport face from './face.png';\r\nimport { Formik } from 'formik';\r\nimport { required, email, minLength } from '../../services/validations';\r\nimport backend from '../../services/backend'\r\n\r\nimport classNames from 'classnames';\r\n\r\nimport AppHeader from '../../components/app-header'\r\nimport AppMenu from '../../components/app-menu'\r\nimport SocialLogin from '../social-login/SocialLogin'\r\n\r\n\r\n\r\nconst initialValues = {\r\n  email: '',\r\n  password: ''\r\n};\r\n\r\nconst validate = values => {\r\n  let errors = {};\r\n  let emailError = required(values.email) || email(values.email);\r\n  if (emailError) {\r\n    errors.email = emailError;\r\n  }\r\n  let passwordError = required(values.password) || minLength(values.password, 6);\r\n  if (passwordError) {\r\n    errors.password = passwordError;\r\n  }\r\n  return errors\r\n};\r\n\r\n\r\nfunction SigninPage(props) {\r\n\r\n  function onSuccessFacebookLogin(res) {\r\n    props.login(res, 'facebook').then(() => {\r\n      backend.getProfileInfo().then(() => {\r\n        props.history.push('/');\r\n      });\r\n    });\r\n  }\r\n\r\n  return (\r\n    <div className=\"SigninPage\">\r\n      <AppHeader />\r\n      <AppMenu />\r\n      <div className=\"wrapper\">\r\n        <div className=\"left-col\">\r\n          <img src={face} alt=\"\"/>\r\n        </div>\r\n        <div className=\"right-col\">\r\n          <div className=\"form-wrapper\">\r\n\r\n            <h5 className=\"title\">Sign in</h5>\r\n            <SocialLogin onSuccessFacebookLogin={onSuccessFacebookLogin} />\r\n            <Formik\r\n              initialValues={initialValues}\r\n              validate={validate}\r\n              validateOnChange={true}\r\n              onSubmit={(values, { setSubmitting }) => {\r\n                console.log(values);\r\n                backend.signin(values)\r\n                  .then(response => {\r\n                    console.log(response);\r\n                  })\r\n                  .catch(() => {})\r\n                  .finally(() => setSubmitting(false))\r\n              }}\r\n            >\r\n              {props => {\r\n                const {\r\n                  values,\r\n                  errors,\r\n                  touched,\r\n                  isSubmitting,\r\n                  handleChange,\r\n                  handleBlur,\r\n                  handleSubmit,\r\n                } = props;\r\n                return (\r\n                  <form onSubmit={handleSubmit}>\r\n                    <div className=\"control form-group\">\r\n                      <label htmlFor=\"email\" className=\"label\">Email</label>\r\n                      <input\r\n                        id=\"email\"\r\n                        name=\"email\"\r\n                        type=\"text\"\r\n                        value={values.email}\r\n                        placeholder=\"Email\"\r\n                        onChange={handleChange}\r\n                        onBlur={handleBlur}\r\n                        className={classNames('input form-control', touched.email && errors.email && 'error')}\r\n                      />\r\n                      { touched.email && errors.email &&\r\n                      <div className=\"error-message\">{ errors.email }</div> }\r\n                    </div>\r\n\r\n                    <div className=\"control form-group\">\r\n                      <label htmlFor=\"password\" className=\"label\">Password</label>\r\n                      <input\r\n                        id=\"password\"\r\n                        name=\"password\"\r\n                        type=\"password\"\r\n                        value={values.password}\r\n                        placeholder=\"Password\"\r\n                        onChange={handleChange}\r\n                        className={classNames('input form-control', touched.password && errors.password && 'error')}\r\n                      />\r\n                      { touched.password && errors.password &&\r\n                      <div className=\"error-message\">{ errors.password }</div> }\r\n                    </div>\r\n                    <div className=\"control form-group\">\r\n                      <input\r\n                        type=\"submit\"\r\n                        value=\"Sign In\"\r\n                        disabled={isSubmitting}\r\n                        className=\"submit btn btn-block btn-lg btn-primary\"\r\n                      />\r\n                    </div>\r\n                  </form>\r\n                );\r\n              }}\r\n            </Formik>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\n\r\nexport default connect(\r\n  state => ({\r\n    sets: state.sets\r\n  }),\r\n  {\r\n    getSets,\r\n    login\r\n  }\r\n)(SigninPage)\r\n","import React from 'react';\nimport { HashRouter as Router, Route, Switch, matchPath } from \"react-router-dom\";\n\nimport \"react-tabs/style/react-tabs.css\";\nimport { ToastContainer } from 'react-toastify';\nimport 'react-toastify/dist/ReactToastify.css';\nimport './App.scss';\nimport AvatarPage from './components/avatar-page'\nimport SignupPage from './components/signup-page'\nimport SigninPage from './components/signin-page'\nimport { connect } from 'react-redux'\nimport { getProfileInfo } from './reducers/preview'\n\nclass App extends React.Component {\n\n  constructor(props) {\n    props.getProfileInfo();\n    super(props);\n  }\n\n  render() {\n    return (\n      <div className=\"App\">\n        <ToastContainer autoClose={4000} hideProgressBar={true}/>\n        {/*<Router basename={process.env.REACT_APP_ROUTER_BASE_URL || ''}>*/}\n        <Router>\n          <Switch>\n            <Route path=\"/\" exact component={AvatarPage} />\n            <Route path=\"/signup\" exact component={SignupPage} />\n            <Route path=\"/signin\" exact component={SigninPage} />\n            <Route path=\"/:setId\" exact component={AvatarPage} />\n          </Switch>\n        </Router>\n      </div>\n    );\n  }\n}\n\n\nexport default connect(\n  null,\n  {\n    getProfileInfo\n  }\n)(App)\n\n\n\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { Provider } from 'react-redux'\nimport { createStore, applyMiddleware } from 'redux'\nimport reducer from './reducers/preview'\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\nimport { composeWithDevTools } from 'redux-devtools-extension/developmentOnly'\nimport ReduxThunk from 'redux-thunk'\n\n\nconst store = createStore(reducer, composeWithDevTools(applyMiddleware(ReduxThunk)));\n\nReactDOM.render(\n  <Provider store={store}>\n    <App />\n  </Provider>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}